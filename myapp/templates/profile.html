{% extends 'layout/base.html' %}
{% load static %}

{% block title %}Perfil - TuChanchita{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'styles/login.css' %}">
<style>
  .profile-container h2 {
    text-align: center;
    margin-bottom: 20px;
  }

  .profile-container p {
    margin: 6px 0;
  }

  .section {
    margin-top: 25px;
  }

  .card-list {
    list-style: none;
    padding-left: 0;
  }

  .card-list li {
    margin-bottom: 10px;
    padding: 10px;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 8px;
  }

  .profile-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 20px;
  }

  .profile-actions a button {
    width: 100%;
  }
<<<<<<< Updated upstream
=======

.profile-photo-wrapper {
  display: flex;
  justify-content: center;
  margin-bottom: 20px;
}

.photo-container {
  position: relative;
  width: 240px;
  height: 240px;
}

.profile-photo {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid white;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
}

#btnAddPhoto {
  position: absolute;
  bottom: 10px;
  right: 10px;
  font-size: 28px;
  font-weight: bold;
  color: white;
  background-color: #007bff;
  border: none;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 0 6px rgba(0,123,255,0.6);
  transition: background-color 0.3s ease;
}

#btnAddPhoto:hover {
  background-color: #0056b3;
}

/* Responsive */
@media (max-width: 600px) {
  .photo-container {
    width: 150px;
    height: 150px;
  }

  #btnAddPhoto {
    width: 36px;
    height: 36px;
    font-size: 22px;
    bottom: 6px;
    right: 6px;
  }
}


>>>>>>> Stashed changes
</style>
{% endblock %}

{% block content %}
<div class="bubble-container" id="bubble-container"></div>

<main class="center-wrapper">
  <section class="login-container profile-container">
    <h2>Mi Perfil</h2>

<<<<<<< Updated upstream
=======
<div class="profile-photo-wrapper">
  <div class="photo-container">
    {% if user.photo %}
      <img src="{{ user.photo.url }}" alt="Foto de perfil" class="profile-photo">
    {% else %}
      <img src="{% static 'images/default-profile.jpg' %}" alt="Foto por defecto" class="profile-photo">
    {% endif %}

    <form method="POST" enctype="multipart/form-data" action="{% url 'upload_profile_photo' %}" id="photoForm">
      {% csrf_token %}
      <input type="file" name="photo" id="photoInput" accept="image/*" style="display:none;">
      <button type="button" id="btnAddPhoto" title="Cambiar foto" aria-label="Cambiar foto">+</button>
    </form>
  </div>
</div>


</div>

>>>>>>> Stashed changes
    <div class="section">
      <p><strong>Puntos acumulados:</strong> {{ user.points }}</p>
      <p><strong>Bienvenido:</strong> {{ user.first_name }}</p>
      <p><strong>Email:</strong> {{ user.email }}</p>
      <p><strong>Límite mensual:</strong> S/. {{ user.monthly_limit }}</p>

      <div class="profile-actions">
        <a href="{% url 'update_limit' %}">
          <button type="button">Actualizar límite mensual</button>
        </a>
      </div>
    </div>

    <hr class="section">

    <div class="section">
      <h3>Tarjetas Registradas</h3>
      <ul class="card-list">
        {% for card in cards %}
          <li>{{ card.get_tipo_display }} - {{ card.banco }} ****{{ card.ultimos_4_digitos }} (Vence: {{ card.mes_vencimiento }}/{{ card.anio_vencimiento }})</li>
        {% empty %}
          <li>No tienes tarjetas registradas.</li>
        {% endfor %}
      </ul>

      <div class="profile-actions">
        <a href="{% url 'add_card' %}">
          <button type="button">Agregar nueva tarjeta</button>
        </a>
        <a href="{% url 'dashboard' %}">
          <button type="button">← Volver al Dashboard</button>
        </a>
      </div>
    </div>
  </section>
</main>

<script>
  const container = document.getElementById("bubble-container");
  for (let i = 0; i < 20; i++) {
    const bubble = document.createElement("div");
    bubble.classList.add("bubble");
    const size = Math.floor(Math.random() * 150) + 50;
    bubble.style.width = `${size}px`;
    bubble.style.height = `${size}px`;
    bubble.style.top = `${Math.random() * 100}%`;
    bubble.style.left = `${Math.random() * 100}%`;
    bubble.style.animationDuration = `${(Math.random() * 1.5 + 3.5).toFixed(1)}s`;
    container.appendChild(bubble);
  }
</script>
<<<<<<< Updated upstream
=======

<script>
  document.getElementById('btnAddPhoto').addEventListener('click', function() {
  document.getElementById('photoInput').click();
});

document.getElementById('photoInput').addEventListener('change', function() {
  if (this.files && this.files.length > 0) {
    // Enviar el formulario automáticamente si se seleccionó un archivo
    document.getElementById('photoForm').submit();
  }
  // Si se cancela, no pasa nada
});
</script>
>>>>>>> Stashed changes
{% endblock %}
